/*!
 * angular-weibo-emotify - Angular directive and service to emotify weibo text
 * https://github.com/RoberMac/angular-weibo-emotify
 *
 * Copyright (c) 2015 RoberTu <robertu0717@gmail.com>
 * @license MIT
 * @version v0.2.0
 */
angular.module("weibo-emotify",[]).provider("weiboEmotify",function(){this.emotionsURL="https://raw.githubusercontent.com/RoberMac/angular-weibo-emotify/master/dist/emotions_v1.min.json",this.setEmotionsURL=function(t){this.emotionsURL=t},this.$get=["$window","$http","$q",function(t,e,i){function n(t){if(t){var e=t.replace(/\[[\u4e00-\u9fa5\w]+\]/g,function(t){var e=t.replace(/[\[\]]/g,""),i=r[e];if(!i)return t;var n="http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/",o=i.replace(/\-|\+|\@/g,"/").replace("?",""),s=i.indexOf("-")>0?"_org":i.indexOf("+")>0?"_thumb":"",c=i.indexOf("?")>0?".png":".gif";return'<img text="'+t+'" alt="'+t+'" src="'+n+o+s+c+'">'});return e||""}}var o=t.localStorage,r=o&&JSON.parse(o.getItem("weiboEmotions")),s=this.emotionsURL;return i(function(t,i){r&&"1.0"===r._v?t():e.get(s).success(function(e){"[object Object]"===Object.prototype.toString.call(e)?"1.0"===e._v?(o&&o.setItem("weiboEmotions",JSON.stringify(e)),r=e,t()):i("`emotions_list` is not v1.0"):i("`emotions_list` is not a Object")}).error(function(t){i(t)})}).then(function(){return n})["catch"](function(t){throw new Error(t)})}]}).directive("weiboEmotify",["$timeout","weiboEmotify",function(t,e){return{restrict:"A",link:function(i,n,o){e.then(function(e){t(function(){n.html(e(n.html()))})})}}}]);
//# sourceMappingURL=angular-weibo-emotify.min.js.map